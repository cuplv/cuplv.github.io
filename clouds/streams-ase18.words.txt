Safe Stream-Based Programming with Refinement Types
      